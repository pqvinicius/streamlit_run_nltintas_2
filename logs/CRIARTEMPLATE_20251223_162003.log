2025-12-23 16:20:03 | INFO    | ===========================================================================
2025-12-23 16:20:03 | INFO    | PIPELINE | Sistema de Logging Iniciado: C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\logs\CRIARTEMPLATE_20251223_162003.log
2025-12-23 16:20:03 | INFO    | PIPELINE | Modo: DEV
2025-12-23 16:20:03 | INFO    | ===========================================================================
2025-12-23 16:20:03 | INFO    | BACKUP | Backup diário realizado em: C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\backups\2025-12-23 (2 arquivos)
2025-12-23 16:20:03 | INFO    | PIPELINE | INICIANDO EXECUCAO: src.web_automation
2025-12-23 16:20:03 | INFO    | INGESTAO | Iniciando download de planilhas...
2025-12-23 16:20:06 | INFO    | Iniciando automação web...
2025-12-23 16:20:06 | INFO    | Acessando o site: https://bi-cloud-partner3.citelsoftware.com.br:41451
2025-12-23 16:20:09 | INFO    | Login realizado com sucesso!
2025-12-23 16:20:15 | INFO    | Iniciando exportação do painel de Meta por Vendedor...
2025-12-23 16:20:30 | WARNING | Widget Meta Vendedor não encontrado.
2025-12-23 16:20:30 | INFO    | Fluxo de Meta Vendedor concluído. Finalizando automação.
2025-12-23 16:20:30 | INFO    | Fechando o navegador.
2025-12-23 16:20:32 | INFO    | Automação web concluída. Arquivos baixados: []
2025-12-23 16:20:32 | INFO    | INGESTAO | Usando arquivo cached mais recente: MetaVendedor_1612.xlsx
2025-12-23 16:20:32 | INFO    | PROCESSAMENTO | Iniciando processamento: MetaVendedor_1612.xlsx
2025-12-23 16:20:32 | INFO    | INGESTAO | Tentativa 1/3 de leitura do Meta Vendedor
2025-12-23 16:20:32 | INFO    | INGESTAO | Validando integridade do Excel (pré-header)
2025-12-23 16:20:32 | INFO    | INGESTAO | Excel passou na validação de integridade
2025-12-23 16:20:32 | INFO    | INGESTAO | Arquivo válido detectado.
2025-12-23 16:20:32 | INFO    | INGESTAO | Iniciando analise de header: MetaVendedor_1612.xlsx
2025-12-23 16:20:32 | INFO    | INGESTAO | Header Linha 0: Valid=1 Cols=['META POR VENDEDOR - S / DEPARTAMENTO TELE VENDAS (MES ALTERNADO)', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '']
2025-12-23 16:20:32 | INFO    | INGESTAO | Header Linha 1: Valid=1 Cols=['META DE VENDA POR VENDEDOR SEM DEPARTAMENTO TELEVENDAS', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '']
2025-12-23 16:20:32 | INFO    | INGESTAO | Header Linha 2: Valid=0 Cols=['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '']
2025-12-23 16:20:32 | INFO    | INGESTAO | Header Linha 3: Valid=24 Cols=['COD.', 'NOME', 'META', 'FATURADO MES', '% ALCANCE', 'FAT. PROJETADO', '% PROJETADO', 'FALTA META MES', 'META DIARIA', 'FAT. HOJE', 'VALOR ABERTO', '% FAT. + ABERTO', 'PRAZO MEDIO', 'VENDAS', 'TICKET MEDIO', 'QTD ITENS POR NOTA', 'CARTEIRA', 'ATEND.', '% ATEND.', 'META MARG.', '% MARGEM', 'TOTAL DESCONTO', 'META DESCONTO', '% DESCONTO']
2025-12-23 16:20:32 | INFO    | INGESTAO | Cabeçalho detectado na linha 3
2025-12-23 16:20:32 | ERROR   | RANKING | Falha crítica ao gerar ranking.
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\main.py", line 83, in _run_ranking_diario
    destino_vendedor = gerar_ranking_vendedores(
        meta_vendedor,
        data_dir,
        send_whatsapp=send_whatsapp
    )
  File "C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\src\daily_seller_ranking.py", line 13, in gerar_ranking_vendedores
    return service.execute(meta_arquivo, destino_dir, send_whatsapp=send_whatsapp)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\src\services\ranking_service.py", line 333, in execute
    df_completo = self._preparar_dataframe(meta_path)
  File "C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\src\services\ranking_service.py", line 214, in _preparar_dataframe
    df["Vendedor"] = df["Vendedor"].astype(str).str.strip().str.replace(r"(?i)^loja\s*[:.\-]?\s*", "", regex=True).title()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\venv\Lib\site-packages\pandas\core\generic.py", line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
AttributeError: 'Series' object has no attribute 'title'
2025-12-23 16:20:32 | INFO    | PIPELINE | Execucao finalizada com sucesso
