2025-12-23 15:27:45 | INFO    | ===========================================================================
2025-12-23 15:27:45 | INFO    | PIPELINE | Sistema de Logging Iniciado: C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\logs\CRIARTEMPLATE_20251223_152745.log
2025-12-23 15:27:45 | INFO    | PIPELINE | Modo: DEV
2025-12-23 15:27:45 | INFO    | ===========================================================================
2025-12-23 15:27:46 | INFO    | PIPELINE | INICIANDO EXECUCAO: src.web_automation
2025-12-23 15:27:46 | INFO    | INGESTAO | Iniciando download de planilhas...
2025-12-23 15:27:48 | INFO    | Iniciando automação web...
2025-12-23 15:27:48 | INFO    | Acessando o site: https://bi-cloud-partner3.citelsoftware.com.br:41451
2025-12-23 15:27:52 | INFO    | Login realizado com sucesso!
2025-12-23 15:27:53 | INFO    | Removendo sessões remotas pendentes...
2025-12-23 15:28:10 | INFO    | Arquivo existente encontrado: MetaVendedor_2312.xlsx. Removendo para garantir atualização diária.
2025-12-23 15:28:10 | INFO    | Iniciando exportação do painel de Meta por Vendedor...
2025-12-23 15:28:15 | INFO    | Solicitado download Meta Vendedor. Aguardando...
2025-12-23 15:28:45 | INFO    | Arquivo movido: Meta por vendedor - S _ Departamento TELE VENDAS (Mês Alternado) - 23 Dec 2025 (5).xlsx -> MetaVendedor_2312.xlsx
2025-12-23 15:28:45 | INFO    | Arquivo Meta Vendedor baixado: MetaVendedor_2312.xlsx
2025-12-23 15:28:45 | INFO    | Fluxo de Meta Vendedor concluído. Finalizando automação.
2025-12-23 15:28:45 | INFO    | Fechando o navegador.
2025-12-23 15:28:47 | INFO    | Automação web concluída. Arquivos baixados: ['meta_vendedor']
2025-12-23 15:28:47 | INFO    | PROCESSAMENTO | Iniciando processamento: MetaVendedor_2312.xlsx
2025-12-23 15:28:47 | INFO    | INGESTAO | Tentativa 1/3 de leitura do Meta Vendedor
2025-12-23 15:28:48 | ERROR   | INGESTAO | Arquivo inválido (Erro ao recuperar resultados). Apagando arquivo.
2025-12-23 15:28:48 | INFO    | INGESTAO | Arquivo inválido removido com sucesso.
2025-12-23 15:28:48 | INFO    | INGESTAO | Aguardando 40s antes de nova tentativa...
2025-12-23 15:29:28 | INFO    | INGESTAO | Tentativa 2/3 de leitura do Meta Vendedor
2025-12-23 15:29:28 | WARNING | INGESTAO | Arquivo ainda não existe. Aguardando 40s...
2025-12-23 15:30:08 | INFO    | INGESTAO | Tentativa 3/3 de leitura do Meta Vendedor
2025-12-23 15:30:08 | WARNING | INGESTAO | Arquivo ainda não existe. Aguardando 40s...
2025-12-23 15:30:48 | ERROR   | ERRO AO GERAR RANKING DE VENDEDORES
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\src\daily_seller_ranking.py", line 627, in gerar_ranking_vendedores
    df_completo = _preparar_dataframe(meta_path, cfg)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\src\daily_seller_ranking.py", line 271, in _preparar_dataframe
    df = _carregar_planilha(path, cfg)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\src\daily_seller_ranking.py", line 223, in _carregar_planilha
    df_raw = carregar_excel_meta_vendedor_com_retry(path_str, logger)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\src\daily_seller_ranking.py", line 210, in carregar_excel_meta_vendedor_com_retry
    raise RuntimeError(
RuntimeError: INGESTAO | Falha crítica: Não foi possível obter um Excel válido do Meta Vendedor após 3 tentativas.
2025-12-23 15:30:48 | ERROR   | RANKING | Falha crítica ao gerar ranking.
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\main.py", line 86, in _run_ranking_diario
    destino_vendedor = gerar_ranking_vendedores(meta_vendedor, data_dir)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\src\daily_seller_ranking.py", line 627, in gerar_ranking_vendedores
    df_completo = _preparar_dataframe(meta_path, cfg)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\src\daily_seller_ranking.py", line 271, in _preparar_dataframe
    df = _carregar_planilha(path, cfg)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\src\daily_seller_ranking.py", line 223, in _carregar_planilha
    df_raw = carregar_excel_meta_vendedor_com_retry(path_str, logger)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\src\daily_seller_ranking.py", line 210, in carregar_excel_meta_vendedor_com_retry
    raise RuntimeError(
RuntimeError: INGESTAO | Falha crítica: Não foi possível obter um Excel válido do Meta Vendedor após 3 tentativas.
2025-12-23 15:30:48 | INFO    | PIPELINE | Execucao finalizada com sucesso
