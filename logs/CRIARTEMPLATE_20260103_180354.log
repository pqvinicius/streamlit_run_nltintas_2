2026-01-03 18:03:54 | INFO    | ===========================================================================
2026-01-03 18:03:54 | INFO    | PIPELINE | Sistema de Logging Iniciado: C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingVendedores2.0\logs\CRIARTEMPLATE_20260103_180354.log
2026-01-03 18:03:54 | INFO    | PIPELINE | Modo: DEV
2026-01-03 18:03:54 | INFO    | ===========================================================================
2026-01-03 18:03:55 | INFO    | BACKUP | Backup di√°rio realizado em: C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingVendedores2.0\backups\2026-01-03 (2 arquivos)
2026-01-03 18:03:55 | INFO    | BACKUP | Backups locais criados junto dos arquivos originais
2026-01-03 18:03:55 | INFO    | PIPELINE | INICIANDO EXECUCAO: src.web_automation
2026-01-03 18:03:55 | INFO    | PIPELINE | MODO: BATCH | Envio WhatsApp: DESABILITADO
2026-01-03 18:03:55 | INFO    | INGESTAO | Iniciando download de planilhas...
2026-01-03 18:03:55 | INFO    | INGESTAO | Tentativa 1/3
2026-01-03 18:03:55 | INFO    | üåê [WEB] Ativando Headless Moderno. Motivo: Modo Noturno (BATCH)
2026-01-03 18:03:57 | INFO    | Iniciando automa√ß√£o web...
2026-01-03 18:03:57 | INFO    | Acessando o site: https://bi-cloud-partner3.citelsoftware.com.br:41451
2026-01-03 18:04:06 | INFO    | Fluxo de login finalizado.
2026-01-03 18:04:06 | INFO    | Removendo sess√µes remotas pendentes...
2026-01-03 18:04:08 | INFO    | Aguardando 40 segundos para estabiliza√ß√£o do BI...
2026-01-03 18:04:48 | INFO    | Arquivo existente encontrado: MetaVendedor_0301.xlsx. Removendo para garantir atualiza√ß√£o di√°ria.
2026-01-03 18:04:48 | INFO    | Iniciando exporta√ß√£o do painel de Meta por Vendedor...
2026-01-03 18:04:51 | INFO    | Tentativa de Exporta√ß√£o BI 1/3
2026-01-03 18:04:56 | INFO    | Solicitado download Meta Vendedor. Aguardando...
2026-01-03 18:05:26 | INFO    | Arquivo movido: Meta por vendedor - S _ Departamento TELE VENDAS (M√™s Alternado) - 3 Jan 2026 (2).xlsx -> MetaVendedor_0301.xlsx
2026-01-03 18:05:26 | INFO    | Validando conte√∫do do arquivo (BI Check)...
2026-01-03 18:05:26 | INFO    | Arquivo validado com sucesso!
2026-01-03 18:05:26 | INFO    | Fluxo de Meta Vendedor conclu√≠do. Finalizando automa√ß√£o.
2026-01-03 18:05:26 | INFO    | Fechando o navegador.
2026-01-03 18:05:28 | INFO    | Automa√ß√£o web conclu√≠da. Arquivos baixados: ['meta_vendedor']
2026-01-03 18:05:28 | INFO    | INGESTAO | Validando sanidade do arquivo...
2026-01-03 18:05:28 | INFO    | INGESTAO | Arquivo v√°lido e saneado. Prosseguindo.
2026-01-03 18:05:28 | INFO    | PROCESSAMENTO | Iniciando processamento: MetaVendedor_0301.xlsx
2026-01-03 18:05:28 | INFO    | INGESTAO | Tentativa 1/3 de leitura do Meta Vendedor
2026-01-03 18:05:28 | INFO    | INGESTAO | Validando integridade do Excel (pr√©-header)
2026-01-03 18:05:28 | INFO    | INGESTAO | Excel passou na valida√ß√£o de integridade
2026-01-03 18:05:28 | INFO    | INGESTAO | Arquivo v√°lido detectado.
2026-01-03 18:05:28 | INFO    | INGESTAO | Iniciando analise de header: MetaVendedor_0301.xlsx
2026-01-03 18:05:28 | INFO    | INGESTAO | Header Linha 0: Valid=1 Cols=['META POR VENDEDOR - S / DEPARTAMENTO TELE VENDAS (MES ALTERNADO)', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '']
2026-01-03 18:05:28 | INFO    | INGESTAO | Header Linha 1: Valid=1 Cols=['META DE VENDA POR VENDEDOR SEM DEPARTAMENTO TELEVENDAS', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '']
2026-01-03 18:05:28 | INFO    | INGESTAO | Header Linha 2: Valid=0 Cols=['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '']
2026-01-03 18:05:28 | INFO    | INGESTAO | Header Linha 3: Valid=24 Cols=['COD.', 'NOME', 'META', 'FATURADO MES', '% ALCANCE', 'FAT. PROJETADO', '% PROJETADO', 'FALTA META MES', 'META DIARIA', 'FAT. HOJE', 'VALOR ABERTO', '% FAT. + ABERTO', 'PRAZO MEDIO', 'VENDAS', 'TICKET MEDIO', 'QTD ITENS POR NOTA', 'CARTEIRA', 'ATEND.', '% ATEND.', 'META MARG.', '% MARGEM', 'TOTAL DESCONTO', 'META DESCONTO', '% DESCONTO']
2026-01-03 18:05:28 | INFO    | INGESTAO | Cabe√ßalho detectado na linha 3
2026-01-03 18:05:28 | INFO    | FILTER | 14 Gerentes removidos do ranking.
2026-01-03 18:05:28 | INFO    | PROCESSAMENTO | Vendedores: 81. P√°ginas: 7
2026-01-03 18:05:29 | INFO    | üéÆ GAMIFICACAO | Engine: OK
2026-01-03 18:05:29 | ERROR   | RANKING | Falha cr√≠tica ao gerar ranking.
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingVendedores2.0\MAIN.py", line 131, in _run_ranking_diario
    destino_vendedor = gerar_ranking_vendedores(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingVendedores2.0\src\daily_seller_ranking.py", line 13, in gerar_ranking_vendedores
    return service.execute(meta_arquivo, destino_dir, send_whatsapp=send_whatsapp)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingVendedores2.0\src\services\ranking_service.py", line 387, in execute
    paths_pontos = self._gerar_ranking_pontos(engine, destino_dir, logo)
                                                                   ^^^^
UnboundLocalError: cannot access local variable 'logo' where it is not associated with a value
2026-01-03 18:05:29 | ERROR   | PIPELINE | ERRO FATAL N√ÉO TRATADO
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingVendedores2.0\MAIN.py", line 200, in main
    _run_ranking_diario(
  File "C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingVendedores2.0\MAIN.py", line 131, in _run_ranking_diario
    destino_vendedor = gerar_ranking_vendedores(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingVendedores2.0\src\daily_seller_ranking.py", line 13, in gerar_ranking_vendedores
    return service.execute(meta_arquivo, destino_dir, send_whatsapp=send_whatsapp)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingVendedores2.0\src\services\ranking_service.py", line 387, in execute
    paths_pontos = self._gerar_ranking_pontos(engine, destino_dir, logo)
                                                                   ^^^^
UnboundLocalError: cannot access local variable 'logo' where it is not associated with a value
