2025-12-12 16:30:01 | INFO     | CRIARTEMPLATE | _setup_root_logger:141 | ================================================================================
2025-12-12 16:30:01 | INFO     | CRIARTEMPLATE | _setup_root_logger:142 | Sistema de Logging Iniciado - Arquivo: C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\logs\CRIARTEMPLATE_20251212_163001.log
2025-12-12 16:30:01 | INFO     | CRIARTEMPLATE | _setup_root_logger:143 | Modo: DESENVOLVIMENTO
2025-12-12 16:30:01 | INFO     | CRIARTEMPLATE | _setup_root_logger:146 | Diretório de logs: C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\logs
2025-12-12 16:30:01 | INFO     | CRIARTEMPLATE | _setup_root_logger:147 | ================================================================================
2025-12-12 16:30:02 | INFO     | CRIARTEMPLATE | main:172 | ================================================================================
2025-12-12 16:30:02 | INFO     | CRIARTEMPLATE | main:173 | INICIANDO CRIARTEMPLATE
2025-12-12 16:30:02 | INFO     | CRIARTEMPLATE | main:174 | Modo: DESENVOLVIMENTO
2025-12-12 16:30:02 | INFO     | CRIARTEMPLATE | main:177 | ================================================================================
2025-12-12 16:30:02 | INFO     | CRIARTEMPLATE | main:182 | Configurações carregadas. Diretório base: C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas
2025-12-12 16:30:02 | INFO     | CRIARTEMPLATE | main:188 | Executando ranking diário...
2025-12-12 16:30:02 | INFO     | CRIARTEMPLATE | _run_ranking_diario:62 | Baixando planilha 'Meta por empresa geral' para o ranking diário...
2025-12-12 16:31:56 | INFO     | CRIARTEMPLATE | _run_ranking_diario:77 | Gerando ranking diário a partir de C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\data\meta_empresa_20251212.xlsx ...
2025-12-12 16:32:06 | INFO     | CRIARTEMPLATE | _run_ranking_diario:83 | ✅ Ranking diário gerado com sucesso: C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\data\ranking_diario_p1.png
2025-12-12 16:32:06 | INFO     | CRIARTEMPLATE | _run_ranking_diario:102 | Gerando ranking de vendedores a partir de C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\data\MetaVendedor_1212.xlsx ...
2025-12-12 16:32:06 | ERROR    | CRIARTEMPLATE | _run_ranking_diario:108 | ❌ ERRO ao gerar ranking de vendedores: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\main.py", line 104, in _run_ranking_diario
    destino_vendedor = gerar_ranking_vendedores(meta_vendedor, data_dir)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\src\daily_seller_ranking.py", line 444, in gerar_ranking_vendedores
    df_completo = _preparar_dataframe(meta_path, cfg)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\src\daily_seller_ranking.py", line 258, in _preparar_dataframe
    df = _limpar_colunas_numericas(df, tuple(cols_to_clean))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\src\daily_seller_ranking.py", line 137, in _limpar_colunas_numericas
    df[coluna] = df[coluna].apply(_parse_ptbr_number)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\frame.py", line 10401, in apply
    return op.apply().__finalize__(self, method="apply")
           ^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\src\daily_seller_ranking.py", line 117, in _parse_ptbr_number
    if pd.isna(valor):
       ^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\generic.py", line 1580, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-12-12 16:32:06 | INFO     | CRIARTEMPLATE | _run_ranking_diario:127 | Gerando ranking semanal...
2025-12-12 16:32:16 | INFO     | CRIARTEMPLATE | _run_ranking_diario:130 | Ranking semanal gerado: C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\data\ranking_semanal_p1.png
2025-12-12 16:32:16 | INFO     | CRIARTEMPLATE | _run_ranking_diario:130 | Ranking semanal gerado: C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\data\ranking_semanal_p2.png
2025-12-12 16:32:16 | INFO     | CRIARTEMPLATE | _run_ranking_diario:135 | Gerando ranking mensal...
2025-12-12 16:32:26 | INFO     | CRIARTEMPLATE | _run_ranking_diario:138 | Ranking mensal gerado: C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\data\ranking_mensal_p1.png
2025-12-12 16:32:26 | INFO     | CRIARTEMPLATE | _run_ranking_diario:138 | Ranking mensal gerado: C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\data\ranking_mensal_p2.png
2025-12-12 16:32:26 | INFO     | CRIARTEMPLATE | _run_ranking_diario:148 | Gerando análises avançadas...
2025-12-12 16:32:26 | INFO     | CRIARTEMPLATE | _run_ranking_diario:149 | Banco de dados: C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\data\historico_meta.db (existe: True)
2025-12-12 16:32:26 | INFO     | CRIARTEMPLATE | _run_ranking_diario:150 | Diretório de dados: C:\Users\Usuario\Documents\Scripts\EM DESENVOLVIMENTO RankingLojas\data
2025-12-12 16:38:39 | INFO     | CRIARTEMPLATE | _run_ranking_diario:158 | Análises avançadas geradas com sucesso
2025-12-12 16:38:39 | INFO     | CRIARTEMPLATE | main:191 | ================================================================================
2025-12-12 16:38:39 | INFO     | CRIARTEMPLATE | main:192 | FLUXO FINALIZADO COM SUCESSO
2025-12-12 16:38:39 | INFO     | CRIARTEMPLATE | main:193 | ================================================================================
